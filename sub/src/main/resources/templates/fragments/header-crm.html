<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
</head>
<body>
<!-- ========================================
     NAVBAR ESPEC√çFICA DO M√ìDULO CRM
     ======================================== -->
<header th:fragment="header-crm" class="topbar">
    <div class="brand">
        <a class="brand-link" th:href="@{/crm/dashboard}">
            <img class="brand-logo" th:src="@{/images/ub_02_2.jpeg}" alt="SUB" title="Dashboard CRM">
            <span class="brand-title">SUB<span class="text-muted small ms-2">| CRM Vendas</span></span>
        </a>
    </div>

    <input type="checkbox" id="navToggle" class="nav-toggle" aria-hidden="true">
    <label class="nav-toggle-label" for="navToggle" aria-label="Alternar navega√ß√£o">
        <span></span>
        <span></span>
        <span></span>
    </label>

    <nav class="topbar-nav" aria-label="Navega√ß√£o do CRM">
        <ul class="nav-links">
            <li>
                <a th:href="@{/crm/dashboard}">
                    <i class="bi bi-speedometer2 me-1"></i>
                    Dashboard
                </a>
            </li>
            <li>
                <a th:href="@{/crm/vendas}">
                    <i class="bi bi-funnel me-1"></i>
                    Funil de Vendas
                </a>
            </li>
            <li>
                <a th:href="@{/dashboard}" class="btn btn-outline-primary btn-sm">
                    <i class="bi bi-arrow-left me-1"></i>
                    Voltar ao Sistema
                </a>
            </li>

            <!-- Mobile Actions -->
            <li class="nav-item-mobile-action" th:if="${isLoggedIn}">
                <a th:href="@{/notifications}">
                    <i class="bi bi-bell-fill me-1"></i>
                    <span>Notifica√ß√µes</span>
                    <span class="badge bg-primary ms-2" id="mobileNotificationBadge" style="display: none;">0</span>
                </a>
            </li>
            <li class="nav-item-theme nav-item-mobile-action">
                <button type="button" class="theme-toggle" data-theme-toggle>
                    <span class="theme-toggle__icon theme-toggle__icon--dark" aria-hidden="true">üåô</span>
                    <span class="theme-toggle__icon theme-toggle__icon--light" aria-hidden="true">
                        <i class="bi bi-sun-fill"></i></span>
                    <span class="theme-toggle__label"></span>
                </button>
            </li>
            <li class="nav-item-mobile-action" th:if="${isLoggedIn}">
                <a class="btn btn-outline" th:href="@{/logout}">
                    <i class="bi bi-box-arrow-right me-1"></i>
                    <span>Sair</span>
                </a>
            </li>
        </ul>
    </nav>

    <div class="topbar-actions">
        <!-- Bot√£o de Notifica√ß√µes (Desktop) -->
        <div class="notification-bell-wrapper" th:if="${isLoggedIn}">
            <button type="button"
                    class="notification-bell-button"
                    id="notificationBellBtn"
                    aria-label="Notifica√ß√µes"
                    aria-haspopup="true"
                    aria-expanded="false">
                <i class="bi bi-bell-fill" aria-hidden="true"></i>
                <span class="notification-badge" id="notificationBadge" style="display: none;">0</span>
            </button>

            <!-- Dropdown de Notifica√ß√µes -->
            <div class="notification-dropdown" id="notificationDropdown" style="display: none;">
                <div class="notification-dropdown-header">
                    <h6 class="mb-0">Notifica√ß√µes</h6>
                    <button type="button" class="btn btn-sm btn-link text-decoration-none p-0" id="markAllReadBtn" style="display: none;">
                        Marcar todas como lidas
                    </button>
                </div>
                <div class="notification-dropdown-body" id="notificationList">
                    <div class="text-center py-4 text-muted">
                        <div class="spinner-border spinner-border-sm mb-2" role="status">
                            <span class="visually-hidden">Carregando...</span>
                        </div>
                        <p class="small mb-0">Carregando notifica√ß√µes...</p>
                    </div>
                </div>
                <div class="notification-dropdown-footer">
                    <a th:href="@{/notifications}" class="btn btn-sm btn-link text-decoration-none w-100">
                        Ver todas as notifica√ß√µes
                    </a>
                </div>
            </div>
        </div>

        <button type="button" class="theme-toggle" data-theme-toggle>
            <span class="theme-toggle__icon theme-toggle__icon--dark" aria-hidden="true"><i class="bi bi-moon-fill"></i></span>
            <span class="theme-toggle__icon theme-toggle__icon--light" aria-hidden="true"><i class="bi bi-sun-fill"></i></span>
            <span class="theme-toggle__label"></span>
        </button>
        <a class="btn btn-outline" th:if="${isLoggedIn}" th:href="@{/logout}">
            <i class="bi bi-box-arrow-right me-1"></i>
            <span>Sair</span>
        </a>
        <a class="btn btn-primary" th:unless="${isLoggedIn}" th:href="@{/login}">
            <i class="bi bi-box-arrow-in-right me-1"></i>
            <span>Entrar</span>
        </a>
    </div>
</header>
</body>
</html>
