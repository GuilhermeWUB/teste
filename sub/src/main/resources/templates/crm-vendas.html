<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/layout-crm}">
<head>
    <title th:text="${pageTitle} ?: 'SUB - CRM - Vendas'">SUB - CRM - Vendas</title>
    <link rel="stylesheet" th:href="@{/css/kanban-board.css}">
    <link rel="stylesheet" th:href="@{/css/crm-kanban.css}">
    <link rel="stylesheet" th:href="@{/css/vendas-kanban.css}">
</head>
<body>
<section layout:fragment="content" class="vendas-kanban-container">
    <div class="vendas-kanban-wrapper">
        <!-- Cabeçalho do Kanban de Vendas -->
        <div class="vendas-kanban-header">
            <div class="vendas-kanban-title-section">
                <div class="vendas-kanban-icon">
                    <i class="bi bi-kanban"></i>
                </div>
                <div class="vendas-kanban-title-text">
                    <h1>Kanban Vendas</h1>
                    <p>Gerencie o pipeline de vendas com eficiência e visualize o progresso em tempo real</p>
                </div>
            </div>

            <!-- Controles: Busca, Filtros e Ações -->
            <div class="vendas-kanban-controls">
                <div class="vendas-kanban-controls-left">
                    <div class="vendas-kanban-search">
                        <i class="bi bi-search"></i>
                        <input type="text" id="kanban-search" placeholder="Buscar por placa, produto ou cooperativa..." autocomplete="off">
                    </div>
                    <button class="vendas-kanban-filter-btn" type="button">
                        <i class="bi bi-funnel-fill"></i> Filtros
                    </button>
                </div>
                <div class="vendas-kanban-actions">
                    <button class="btn-novo-evento" type="button">
                        <i class="bi bi-plus-circle"></i> Nova negociação
                    </button>
                </div>
            </div>
        </div>

        <!-- Board do Kanban -->
        <div class="vendas-kanban-board kanban-board" aria-label="Kanban de Vendas" role="region">
            <!-- Colunas serão renderizadas dinamicamente pelo JavaScript -->
            <div class="vendas-kanban-column kanban-column" th:each="column : ${crmKanbanColumns}" th:data-stage="${column.name()}">
                <div class="vendas-kanban-column-bar"></div>
                <div class="vendas-kanban-column-header">
                    <div class="vendas-kanban-column-title">
                        <h3 th:text="${column.name()}">Coluna</h3>
                        <span class="vendas-kanban-column-count" th:text="${column.badge()}">0</span>
                    </div>
                    <p class="vendas-kanban-column-helper" th:text="${column.helper()}">Descrição da etapa</p>
                </div>
                <div class="vendas-kanban-tasks tasks-container">
                    <!-- Cards serão renderizados dinamicamente -->
                    <article class="vendas-kanban-card" th:each="deal : ${column.deals()}" draggable="true">
                        <div class="vendas-kanban-card-top">
                            <div>
                                <p class="vendas-kanban-card-label" th:text="${deal.stage()}">Status</p>
                                <h4 class="vendas-kanban-card-title" th:text="${deal.title()}">Produto</h4>
                                <p class="vendas-kanban-card-plate" th:text="${deal.company()}">PLACA: XXX-0000</p>
                            </div>
                            <span class="vendas-kanban-card-status" th:text="${deal.status()}">Etiqueta</span>
                        </div>
                        <div class="vendas-kanban-card-meta">
                            <div class="vendas-kanban-card-amount">
                                <i class="bi bi-currency-dollar"></i>
                                <span th:text="${deal.amount()}">R$ 0,00</span>
                            </div>
                            <div class="vendas-kanban-card-date">
                                <i class="bi bi-calendar4"></i>
                                <span th:text="${deal.dueDate()}">Hoje</span>
                            </div>
                        </div>
                        <div class="vendas-kanban-card-badges">
                            <span class="badge">Cotação Varejo</span>
                            <span class="badge">Negociação</span>
                        </div>
                    </article>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal de Detalhes (será criado pelo JavaScript) -->
    <div id="kanban-modal" class="kanban-modal" style="display: none;"></div>

    <!-- Modal de Criação/Edição (será criado pelo JavaScript) -->
    <div id="create-venda-modal" class="kanban-modal" style="display: none;"></div>
</section>

<!-- Script do Kanban de Vendas -->
<script th:src="@{/js/vendas-kanban.js}" defer></script>
</body>
</html>
