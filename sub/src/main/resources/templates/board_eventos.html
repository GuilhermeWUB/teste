<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{fragments/layout}">
<head>
    <title>Eventos - Kanban</title>
    <link rel="stylesheet" th:href="@{/css/kanban-eventos-v2.css}">
</head>
<body>
    <section layout:fragment="content">
        <div class="kanban-wrapper">
            <!-- Header -->
            <div class="kanban-header">
                <div class="kanban-page-header">
                    <div class="page-info">
                        <span class="page-icon">&lt;/&gt;</span>
                        <div class="page-details">
                            <h1 class="page-title">Sistema de Gestão - Controle de Desenvolvimento</h1>
                            <div class="page-subtitle">
                                <span class="page-breadcrumb">Eventos</span>
                                <span class="divider">•</span>
                                <span>Kanban por Status</span>
                            </div>
                        </div>
                    </div>
                    <div class="page-actions">
                        <button class="kanban-action-btn ghost" type="button">
                            <i class="bi bi-share"></i>
                            Compartilhar
                        </button>
                        <button
                            class="kanban-action-btn primary"
                            type="button"
                            onclick="window.location.href='/events/new'"
                        >
                            <i class="bi bi-plus-lg"></i>
                            Novo Evento
                        </button>
                    </div>
                </div>

                <div class="kanban-toolbar">
                    <div class="kanban-tabs">
                        <button class="kanban-tab active" type="button">
                            <i class="bi bi-kanban"></i>
                            Kanban por Status
                        </button>
                        <button class="kanban-tab" type="button">
                            <i class="bi bi-table"></i>
                            Tabela Geral
                        </button>
                        <button class="kanban-tab" type="button">
                            <i class="bi bi-calendar3"></i>
                            Calendário de Entregas
                        </button>
                    </div>
                    <div class="kanban-toolbar-actions">
                        <button class="kanban-ghost-btn" type="button">
                            <i class="bi bi-view-list"></i>
                            Status
                        </button>
                        <button class="kanban-ghost-btn" type="button" id="kanban-theme-selector" title="Temas">
                            <i class="bi bi-palette"></i>
                            Tema
                        </button>
                    </div>
                </div>

                <div class="kanban-controls">
                    <div class="kanban-controls-left">
                        <!-- Search -->
                        <div class="kanban-search">
                            <i class="bi bi-search"></i>
                            <input
                                type="text"
                                id="kanban-search"
                                placeholder="Buscar eventos..."
                                autocomplete="off"
                            />
                        </div>

                        <!-- Filter buttons -->
                        <div class="kanban-filter-group">
                            <button class="kanban-filter-btn active" data-filter="all">
                                <i class="bi bi-funnel"></i>
                                Todos
                            </button>

                            <button class="kanban-filter-btn" data-filter="URGENTE">
                                <i class="bi bi-exclamation-triangle-fill"></i>
                                Urgente
                            </button>

                            <button class="kanban-filter-btn" data-filter="ALTA">
                                <i class="bi bi-arrow-up"></i>
                                Alta
                            </button>
                        </div>
                    </div>

                    <div class="kanban-controls-right">
                        <!-- View toggle -->
                        <button class="kanban-view-btn" id="kanban-view-toggle" title="Alternar visualização (Board/Lista)">
                            <i class="bi bi-layout-three-columns"></i>
                        </button>

                        <!-- Advanced Filters -->
                        <button class="kanban-view-btn" id="kanban-advanced-filters" title="Filtros Avançados">
                            <i class="bi bi-sliders"></i>
                        </button>

                        <!-- Export -->
                        <button class="kanban-view-btn" id="kanban-export" title="Exportar">
                            <i class="bi bi-download"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Board -->
            <div class="kanban-board">
                <!-- Coluna A Fazer -->
                <div class="kanban-column" data-status="A_FAZER">
                    <div class="column-header">
                        <div class="column-title">
                            <h3>A Fazer</h3>
                            <span class="column-count">0</span>
                        </div>
                        <button class="column-add-btn">
                            <i class="bi bi-plus"></i>
                            Novo
                        </button>
                    </div>
                    <div class="tasks-container" id="column-A_FAZER"></div>
                </div>

                <!-- Coluna Em Andamento -->
                <div class="kanban-column" data-status="EM_ANDAMENTO">
                    <div class="column-header">
                        <div class="column-title">
                            <h3>Em Andamento</h3>
                            <span class="column-count">0</span>
                        </div>
                        <button class="column-add-btn">
                            <i class="bi bi-plus"></i>
                            Novo
                        </button>
                    </div>
                    <div class="tasks-container" id="column-EM_ANDAMENTO"></div>
                </div>

                <!-- Coluna Aguardando -->
                <div class="kanban-column" data-status="AGUARDANDO">
                    <div class="column-header">
                        <div class="column-title">
                            <h3>Aguardando</h3>
                            <span class="column-count">0</span>
                        </div>
                        <button class="column-add-btn">
                            <i class="bi bi-plus"></i>
                            Novo
                        </button>
                    </div>
                    <div class="tasks-container" id="column-AGUARDANDO"></div>
                </div>

                <!-- Coluna Concluído -->
                <div class="kanban-column" data-status="CONCLUIDO">
                    <div class="column-header">
                        <div class="column-title">
                            <h3>Concluído</h3>
                            <span class="column-count">0</span>
                        </div>
                        <button class="column-add-btn">
                            <i class="bi bi-plus"></i>
                            Novo
                        </button>
                    </div>
                    <div class="tasks-container" id="column-CONCLUIDO"></div>
                </div>
            </div>
        </div>

        <!-- Modal -->
        <div id="kanban-modal" class="kanban-modal">
            <div class="kanban-modal-content">
                <div class="kanban-modal-header">
                    <h2>Detalhes do Evento</h2>
                    <button class="kanban-modal-close" onclick="kanbanBoard.closeModal()">
                        <i class="bi bi-x"></i>
                    </button>
                </div>
                <div class="kanban-modal-body">
                    <!-- Conteúdo será preenchido dinamicamente -->
                </div>
            </div>
        </div>
    </section>

    <!-- Scripts carregam FORA do section para garantir timing correto -->
    <script th:src="@{/js/kanban_eventos_v3.js}" defer></script>
    <script th:src="@{/js/kanban_eventos_v3_methods.js}" defer></script>
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Add kanban-specific classes to layout
            const main = document.querySelector('main.page');
            if (main) {
                main.classList.add('kanban-page');
            }

            const container = document.querySelector('main.page > .container');
            if (container) {
                container.classList.add('kanban-full-width');
            }

            const pageContent = document.querySelector('main.page > .container > .page-content');
            if (pageContent) {
                pageContent.classList.add('kanban-content-stretch');
            }
        });
    </script>
</body>
</html>
